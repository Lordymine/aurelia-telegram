# Story 3.2: Async Job Management & Progress

## Status

**Ready for Review**

## Story

**As a** developer,
**I want** to see real-time progress of ADE operations in Telegram,
**so that** I know what's happening without checking the terminal.

## Acceptance Criteria

1. Módulo `src/bridge/job-manager.ts` para tracking de jobs assíncronos
2. Cada operação ADE = um job com id, status, progress, output parcial
3. Mensagem de "Processing..." enviada imediatamente ao iniciar operação
4. Updates incrementais editando a mensagem existente no Telegram (não spam de novas mensagens)
5. Mensagem final com resultado completo ou resumo via Kimi
6. Comando `/jobs` para listar jobs ativos e recentes
7. Comando `/cancel` para cancelar job em andamento (kill process)
8. Testes unitários

## Tasks / Subtasks

- [x] Task 1: Implement JobManager class with job lifecycle (AC: 1-2)
- [x] Task 2: Implement progress tracking and output accumulation (AC: 3-5)
- [x] Task 3: Add /jobs and /cancel command handlers (AC: 6-7)
- [x] Task 4: Write unit tests (AC: 8)
- [x] Task 5: Validation

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-02-05 | 0.1 | Story draft + implementation | River (SM) + Dex (Dev) |

## Dev Agent Record

### Agent Model Used
Claude Opus 4.6 (claude-opus-4-6)

### File List

| File | Status | Description |
|------|--------|-------------|
| `src/bridge/job-manager.ts` | Modified | Full JobManager with queue, progress events, cancel (was stub) |
| `src/bot/handlers/commands.ts` | Modified | Added /jobs, /cancel handlers + JobManager param |
| `src/bot/index.ts` | Modified | Registered /jobs, /cancel commands + JobManager param |
| `src/index.ts` | Modified | Added ClaudeCodeBridge, JobManager exports |
| `tests/unit/bridge/job-manager.test.ts` | Created | 14 tests for JobManager |
